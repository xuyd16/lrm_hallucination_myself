GpuFreq=control_disabled
GpuFreq=control_disabled
GpuFreq=control_disabled
GpuFreq=control_disabled
DDPåˆå§‹åŒ–æˆåŠŸ: rank=0, local_rank=0, world_size=16
ä½¿ç”¨è®¾å¤‡: cuda:0
å¯ç”¨GPUæ•°é‡: 4
  GPU 0: NVIDIA A100-SXM4-40GB
    æ˜¾å­˜: 39.5 GB
  GPU 1: NVIDIA A100-SXM4-40GB
    æ˜¾å­˜: 39.5 GB
  GPU 2: NVIDIA A100-SXM4-40GB
    æ˜¾å­˜: 39.5 GB
  GPU 3: NVIDIA A100-SXM4-40GB
    æ˜¾å­˜: 39.5 GB

=== æ¨¡å‹é…ç½®ä¿¡æ¯ ===
num_regions: 5
max_electrodes_per_region: 24
sequence_length: 1600
embed_dim: 512
num_heads: 16
depth: 26
mlp_ratio: 4.0
drop_rate: 0.2
attn_drop_rate: 0.2
drop_path_rate: 0.2
use_abs_pos: False
use_rel_pos: True
use_time_embed: True
mask_ratio: 0.15
freq_mask_ratio: 0.3
mask_strategy: random
mask_noise_ratio: 0.005
use_moe: True
num_experts: 16
top_k_experts: 2
moe_aux_loss_coeff: 0.01
n_freq_bands: 5
freq_loss_weight: 0.1
time_loss_weight: 0.9
lr: 3e-05
weight_decay: 0.0001
warmup_epochs: 10
use_amp: True
clip_grad: 1.0
batch_size: 8
use_layer_norm: True
use_batch_norm: True
eps: 1e-08
init_std: 0.02
electrode_names: ['Fp1', 'Fp2', 'F3', 'F4', 'F7', 'F8', 'Fz', 'C3', 'C4', 'Cz', 'P3', 'P4', 'P7', 'P8', 'Pz', 'O1', 'O2', 'Oz', 'T3', 'T4', 'T5', 'T6']
region_names: ['frontal', 'central', 'parietal', 'temporal', 'occipital']
debug: False
freq_eval: True
use_channel_embed: True
channel_embed_dim: 32
num_brain_regions: 5
channel_gat_initial_dim: 32
intra_region_gat_heads: 4
intra_region_gat_dim_per_head: 32
region_agg_attention_dim: 64
inter_region_gat_heads: 4
inter_region_gat_dim_per_head: 64
æ¨¡å‹å·²åˆ›å»ºå¹¶ç§»åŠ¨åˆ°è®¾å¤‡: cuda:0
æ¨¡å‹å·²ä½¿ç”¨DDPå°è£…åœ¨è®¾å¤‡ 0
ä¼˜åŒ–å™¨å·²åˆ›å»ºï¼Œå­¦ä¹ ç‡: 3e-05
DDPè®­ç»ƒï¼Œä¸–ç•Œå¤§å°: 16, æœ‰æ•ˆæ‰¹æ¬¡å¤§å°: 128
åŠ¨æ€æ¢¯åº¦ç´¯ç§¯è®¾ç½®:
  ç›®æ ‡å…¨å±€æ‰¹æ¬¡å¤§å°: 128
  å½“å‰å…¨å±€æ‰¹æ¬¡å¤§å°: 128
  æ¢¯åº¦ç´¯ç§¯æ­¥æ•°: 1
  å®é™…æœ‰æ•ˆå…¨å±€æ‰¹æ¬¡å¤§å°: 128
è®­ç»ƒå™¨å·²åˆ›å»º

============================================================
                           æ¨¡å‹å‚æ•°ç»Ÿè®¡                           
============================================================
æ€»å‚æ•°é‡:                912,173,712
å¯è®­ç»ƒå‚æ•°:               912,173,712
å†»ç»“å‚æ•°:                0
å‚æ•°å¤§å°:                3479.67 MB (FP32)
å‚æ•°å¤§å°:                1739.83 MB (FP16)

------------------------------------------------------------
                          ä¸»è¦æ¨¡å—å‚æ•°åˆ†å¸ƒ                          
------------------------------------------------------------
region_projection.raw_projection.0        1,639,424 (  0.2%)
fusion_module.mlp_t.0                     1,050,624 (  0.1%)
fusion_module.mlp_f.0                     1,050,624 (  0.1%)
layers.0.mlp.experts.0.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.1.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.2.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.3.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.4.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.5.0                  1,050,624 (  0.1%)
layers.0.mlp.experts.6.0                  1,050,624 (  0.1%)
å…¶ä»–æ¨¡å—                                     899,502,218 ( 98.6%)
============================================================

æ­£åœ¨åŠ è½½æ•°æ®: /hkfs/work/workspace/scratch/tum_fmp0582-ictspace/processed_data2
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ BCI_Competition_IV-1_data.h5ï¼ŒåŒ…å« 7 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ Emobrain_data_data.h5ï¼ŒåŒ…å« 15 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ REEG-BACA_data.h5ï¼ŒåŒ…å« 3264 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ Raw_EEG_Data_data.h5ï¼ŒåŒ…å« 20 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ Resting_State_EEG_Data_data.h5ï¼ŒåŒ…å« 22 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ SEED-V_data.h5ï¼ŒåŒ…å« 48 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ SEED_FRA_data.h5ï¼ŒåŒ…å« 24 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ Siena_Scalp_EEG_Database_data.h5ï¼ŒåŒ…å« 40 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TDBrain_data.h5ï¼ŒåŒ…å« 2518 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUAR_data.h5ï¼ŒåŒ…å« 310 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUEP_data.h5ï¼ŒåŒ…å« 2298 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH1.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH10.h5ï¼ŒåŒ…å« 6960 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH2.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH3.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH4.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH5.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH6.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH7.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH8.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUH9.h5ï¼ŒåŒ…å« 6968 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUSL_data.h5ï¼ŒåŒ…å« 88 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ TUSZ_data.h5ï¼ŒåŒ…å« 7276 ä¸ªæ•°æ®é›†
æ£€æµ‹åˆ°åˆå¹¶æ–‡ä»¶ Workload_data.h5ï¼ŒåŒ…å« 72 ä¸ªæ•°æ®é›†
æœ‰æ•ˆæ•°æ®æº: 85675, æ¥è‡ª 25 ä¸ªæ–‡ä»¶, è·³è¿‡æ–‡ä»¶æ•°é‡: 0
æ•°æ®é›†åˆå§‹åŒ–å®Œæˆ: å…±25ä¸ªæ–‡ä»¶, 85675ä¸ªæ•°æ®æº, æ€»æ ·æœ¬æ•°: 53235406
è­¦å‘Š: num_workers=24 å¯èƒ½è¿‡é«˜ï¼Œå»ºè®®è®¾ç½®ä¸º16ä»¥ä¸‹
æ•°æ®åŠ è½½é…ç½®: num_workers=24, æœåŠ¡å™¨CPUæ ¸å¿ƒå……è¶³
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=53235406, æ‰¹æ¬¡å¤§å°=8

==================================================
å¼€å§‹è®­ç»ƒ DualDomain Neural Transformer MEM æ¨¡å‹
å…±100ä¸ªå‘¨æœŸï¼Œæ‰¹æ¬¡å¤§å°:8
==================================================

å­¦ä¹ ç‡è°ƒåº¦å™¨å·²åˆå§‹åŒ–ï¼Œæ€»è®­ç»ƒepochs: 100, æ¯ä¸ªepochçš„æ­¥æ•°: 415902
æ€»è®­ç»ƒæ­¥æ•°: 41590200
å­¦ä¹ ç‡è°ƒåº¦å™¨è®¾ç½®æˆåŠŸ
è­¦å‘Š: æœªæ‰¾åˆ°TensorBoardï¼Œå°†ä¸ä¼šè®°å½•è®­ç»ƒæ—¥å¿—

==================================================
     DualDomain Neural Transformer MEM æ¨¡å‹è®­ç»ƒå¼€å§‹     
==================================================
                     æœ¬æ¬¡è¿è¡Œæ–‡ä»¶å¤¹                      
--------------------------------------------------
è¿è¡Œæ–‡ä»¶å¤¹:          checkpoint/20250815_150118
æœ€ä½³æ¨¡å‹:           checkpoint/20250815_150118/best_model.pt
æœ€åæ¨¡å‹:           checkpoint/20250815_150118/last_model.pt
--------------------------------------------------
                      æ¨¡å‹å‚æ•°ç»Ÿè®¡                      
--------------------------------------------------
æ€»å‚æ•°é‡:           912,173,712
å¯è®­ç»ƒå‚æ•°:          912,173,712
å†»ç»“å‚æ•°:           0
å†…å­˜å ç”¨(FP32):     3479.7 MB
å†…å­˜å ç”¨(FP16):     1739.8 MB

                     ä¸»è¦ç»„ä»¶å‚æ•°åˆ†å¸ƒ                     
--------------------------------------------------
layers                901,022,720 ( 98.8%)
fusion_module           6,830,592 (  0.7%)
region_projection       2,595,846 (  0.3%)
time_reconstruction_head1      820,800 (  0.1%)
time_reconstruction_head2      820,800 (  0.1%)
positional_embedding       61,440 (  0.0%)
intra_region_pos_embedding       12,288 (  0.0%)
freq_reconstruction_head1        2,565 (  0.0%)
freq_reconstruction_head2        2,565 (  0.0%)
region_embedding            2,560 (  0.0%)
norm                        1,024 (  0.0%)

                      è®­ç»ƒé…ç½®ä¿¡æ¯                      
--------------------------------------------------
è®­ç»ƒå‘¨æœŸ:           100
æ‰¹æ¬¡å¤§å°:           8
æœ‰æ•ˆæ‰¹æ¬¡å¤§å°:         128
è®¾å¤‡:             cuda:0
DDPä¸–ç•Œå¤§å°:        16
DDPæ¨¡å¼:          å¯ç”¨
å­¦ä¹ ç‡:            3e-05
æ—¶åŸŸæŸå¤±æƒé‡:         0.9
é¢‘åŸŸæŸå¤±æƒé‡:         0.1
æ··åˆç²¾åº¦:           å¯ç”¨
æ¢¯åº¦ç´¯ç§¯æ­¥æ•°:         1
æ¯ä¸ªå‘¨æœŸçš„æ­¥æ•°:        415902
==================================================


Epoch 1/100
--------------------------------------------------
åºåˆ—é•¿åº¦ (R*E): 120
æ—¶åŸŸé¢„æµ‹å½¢çŠ¶: torch.Size([8, 120, 1600]), ç›®æ ‡å½¢çŠ¶: torch.Size([8, 120, 1600])
é¢‘åŸŸé¢„æµ‹å½¢çŠ¶: torch.Size([8, 120, 5]), ç›®æ ‡å½¢çŠ¶: torch.Size([8, 120, 5])
è®­ç»ƒè¿›åº¦: [=                   ] 1/415902 | æ€»æŸå¤±: 0.18090953 | æ—¶åŸŸ: 0.67457700 | é¢‘åŸŸ: 4.37058449 | LR: 0.00000060 | ç”¨æ—¶: 10.6ç§’è®­ç»ƒè¿›åº¦: [=                   ] 20796/415902 | æ€»æŸå¤±: 0.05485146 | æ—¶åŸŸ: 0.13092405 | é¢‘åŸŸ: 1.53173578 | LR: 0.00000060 | ç”¨æ—¶: 27534.7ç§’è®­ç»ƒè¿›åº¦: [==                  ] 41591/415902 | æ€»æŸå¤±: 0.05186179 | æ—¶åŸŸ: 0.13743718 | é¢‘åŸŸ: 1.17805684 | LR: 0.00000060 | ç”¨æ—¶: 54847.1ç§’è®­ç»ƒè¿›åº¦: [===                 ] 62386/415902 | æ€»æŸå¤±: 0.06386097 | æ—¶åŸŸ: 0.27790326 | é¢‘åŸŸ: 1.12020361 | LR: 0.00000060 | ç”¨æ—¶: 82121.5ç§’è®­ç»ƒè¿›åº¦: [====                ] 83181/415902 | æ€»æŸå¤±: 0.04901791 | æ—¶åŸŸ: 0.11974960 | é¢‘åŸŸ: 1.05334640 | LR: 0.00000060 | ç”¨æ—¶: 109288.8ç§’è®­ç»ƒè¿›åº¦: [=====               ] 103976/415902 | æ€»æŸå¤±: 0.04854652 | æ—¶åŸŸ: 0.12573883 | é¢‘åŸŸ: 0.95936704 | LR: 0.00000060 | ç”¨æ—¶: 136490.2ç§’è®­ç»ƒè¿›åº¦: [======              ] 124771/415902 | æ€»æŸå¤±: 0.04689366 | æ—¶åŸŸ: 0.12659833 | é¢‘åŸsrun: Job step aborted: Waiting up to 32 seconds for job step to finish.
