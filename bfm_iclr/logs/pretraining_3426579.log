GpuFreq=control_disabled
GpuFreq=control_disabled
GpuFreq=control_disabled
GpuFreq=control_disabled
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
    rank, local_rank, world_size = setup_ddp()
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 52, in setup_ddp
    rank, local_rank, world_size = setup_ddp()
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 52, in setup_ddp
    rank, local_rank, world_size = setup_ddp()
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 52, in setup_ddp
    torch.cuda.set_device(local_rank)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 399, in set_device
    torch.cuda.set_device(local_rank)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 399, in set_device
    torch.cuda.set_device(local_rank)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 399, in set_device
    rank, local_rank, world_size = setup_ddp()
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 52, in setup_ddp
    torch.cuda.set_device(local_rank)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 399, in set_device
    torch._C._cuda_setDevice(device)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 293, in _lazy_init
    torch._C._cuda_setDevice(device)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 293, in _lazy_init
    torch._C._cuda_setDevice(device)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 293, in _lazy_init
    torch._C._cuda_setDevice(device)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/cuda/__init__.py", line 293, in _lazy_init
    torch._C._cuda_init()
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero.
    torch._C._cuda_init()
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero.
    torch._C._cuda_init()
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero.
    torch._C._cuda_init()
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero.
srun: error: hkn0632: tasks 12-15: Exited with exit code 1
[rank1]: Traceback (most recent call last):
[rank1]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank1]:     rank, local_rank, world_size = setup_ddp()
[rank1]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank1]:     dist.barrier()
[rank1]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank1]:     work = default_pg.barrier(opts=opts)
[rank1]: torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
[rank1]: Exception raised from doWait at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/TCPStore.cpp:563 (most recent call first):
[rank1]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x1469f14bd897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank1]: frame #1: <unknown function> + 0x12feb87 (0x146a4635eb87 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x146a4a821962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x146a4a8229b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x146a4a7d6d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x146a4a7d6d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x146a4a7d6d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #7: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x1469f2789239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank1]: frame #8: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x1469f27906c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank1]: frame #9: <unknown function> + 0x11b1f10 (0x1469f2798f10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank1]: frame #10: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x1469f279a290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank1]: frame #11: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x1469f27a8dda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank1]: frame #12: <unknown function> + 0x57692d2 (0x146a4a7c92d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #13: <unknown function> + 0x5773d00 (0x146a4a7d3d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #14: <unknown function> + 0x5773e05 (0x146a4a7d3e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #15: <unknown function> + 0x4db0e26 (0x146a49e10e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #16: <unknown function> + 0x175be98 (0x146a467bbe98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #17: <unknown function> + 0x577e1b4 (0x146a4a7de1b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #18: <unknown function> + 0x577ef65 (0x146a4a7def65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank1]: frame #19: <unknown function> + 0xd236c8 (0x146a5274e6c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank1]: frame #20: <unknown function> + 0x47e1ef (0x146a51ea91ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank1]: frame #21: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank1]: frame #22: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #23: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank1]: frame #24: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #25: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank1]: frame #26: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #27: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank1]: frame #28: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #29: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #30: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank1]: frame #31: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #32: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank1]: frame #33: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #34: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #35: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #36: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank1]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank1]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank1]: frame #39: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #40: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #41: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank1]: frame #42: <unknown function> + 0x29590 (0x146a68229590 in /lib64/libc.so.6)
[rank1]: frame #43: __libc_start_main + 0x80 (0x146a68229640 in /lib64/libc.so.6)
[rank1]: frame #44: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank1]: . This may indicate a possible application crash on rank 0 or a network set up issue.
srun: error: hkn0428: task 1: Exited with exit code 1
Traceback (most recent call last):
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
    rank, local_rank, world_size = setup_ddp()
  File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 55, in setup_ddp
    dist.init_process_group(
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 89, in wrapper
    func_return = func(*args, **kwargs)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 1305, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/rendezvous.py", line 199, in _tcp_rendezvous_handler
[rank2]: Traceback (most recent call last):
[rank2]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank2]:     rank, local_rank, world_size = setup_ddp()
[rank2]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank2]:     dist.barrier()
[rank2]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank2]:     return func(*args, **kwargs)
[rank2]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank2]:     work = default_pg.barrier(opts=opts)
[rank2]: torch.distributed.DistBackendError: [2] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank2]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank2]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x148adeac5897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank2]: frame #1: <unknown function> + 0x57c6c1e (0x148b37e2ec1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x148b37e29667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x148b37e29962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x148b37e2a9b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148b37dded51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148b37dded51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148b37dded51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x148adfd91239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x148adfd986c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #10: <unknown function> + 0x11b1f10 (0x148adfda0f10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x148adfda2290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x148adfdb0dda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank2]: frame #13: <unknown function> + 0x57692d2 (0x148b37dd12d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #14: <unknown function> + 0x5773d00 (0x148b37ddbd00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #15: <unknown function> + 0x5773e05 (0x148b37ddbe05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #16: <unknown function> + 0x4db0e26 (0x148b37418e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #17: <unknown function> + 0x175be98 (0x148b33dc3e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #18: <unknown function> + 0x577e1b4 (0x148b37de61b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #19: <unknown function> + 0x577ef65 (0x148b37de6f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank2]: frame #20: <unknown function> + 0xd236c8 (0x148b3fd566c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank2]: frame #21: <unknown function> + 0x47e1ef (0x148b3f4b11ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank2]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank2]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank2]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank2]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank2]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank2]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank2]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank2]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank2]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank2]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank2]: frame #43: <unknown function> + 0x29590 (0x148b55829590 in /lib64/libc.so.6)
[rank2]: frame #44: __libc_start_main + 0x80 (0x148b55829640 in /lib64/libc.so.6)
[rank2]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank2]: . This may indicate a possible application crash on rank 0 or a network set up issue.
    store = _create_c10d_store(result.hostname, result.port, rank, world_size, timeout, use_libuv)
  File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/rendezvous.py", line 174, in _create_c10d_store
[rank3]: Traceback (most recent call last):
[rank3]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank3]:     rank, local_rank, world_size = setup_ddp()
[rank3]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank3]:     dist.barrier()
[rank3]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank3]:     return func(*args, **kwargs)
[rank3]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank3]:     work = default_pg.barrier(opts=opts)
[rank3]: torch.distributed.DistBackendError: [3] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank3]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank3]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x150896c99897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank3]: frame #1: <unknown function> + 0x57c6c1e (0x1508f0002c1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x1508efffd667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x1508efffd962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x1508efffe9b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1508effb2d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1508effb2d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1508effb2d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x150897f65239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x150897f6c6c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #10: <unknown function> + 0x11b1f10 (0x150897f74f10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x150897f76290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x150897f84dda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank3]: frame #13: <unknown function> + 0x57692d2 (0x1508effa52d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #14: <unknown function> + 0x5773d00 (0x1508effafd00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #15: <unknown function> + 0x5773e05 (0x1508effafe05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #16: <unknown function> + 0x4db0e26 (0x1508ef5ece26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #17: <unknown function> + 0x175be98 (0x1508ebf97e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #18: <unknown function> + 0x577e1b4 (0x1508effba1b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #19: <unknown function> + 0x577ef65 (0x1508effbaf65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank3]: frame #20: <unknown function> + 0xd236c8 (0x1508f7f2a6c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank3]: frame #21: <unknown function> + 0x47e1ef (0x1508f76851ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank3]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank3]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank3]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank3]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank3]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank3]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank3]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank3]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank3]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank3]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank3]: frame #43: <unknown function> + 0x29590 (0x15090da29590 in /lib64/libc.so.6)
[rank3]: frame #44: __libc_start_main + 0x80 (0x15090da29640 in /lib64/libc.so.6)
[rank3]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank3]: . This may indicate a possible application crash on rank 0 or a network set up issue.
    return TCPStore(
torch.distributed.DistStoreError: Timed out after 601 seconds waiting for clients. 12/16 clients joined.
[rank5]: Traceback (most recent call last):
[rank5]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank5]:     rank, local_rank, world_size = setup_ddp()
[rank5]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank5]:     dist.barrier()
[rank5]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank5]:     return func(*args, **kwargs)
[rank5]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank5]:     work = default_pg.barrier(opts=opts)
[rank5]: torch.distributed.DistBackendError: [5] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank5]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank5]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14a88363b897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank5]: frame #1: <unknown function> + 0x57c6c1e (0x14a8dc9a4c1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14a8dc99f667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14a8dc99f962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14a8dc9a09b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a8dc954d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a8dc954d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a8dc954d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14a884907239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank5]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14a88490e6c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank5]: frame #10: <unknown function> + 0x11b1f10 (0x14a884916f10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank5]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14a884918290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank5]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14a884926dda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank7]: Traceback (most recent call last):
[rank7]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank7]:     rank, local_rank, world_size = setup_ddp()
[rank7]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank7]:     dist.barrier()
[rank7]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank7]:     return func(*args, **kwargs)
[rank7]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank7]:     work = default_pg.barrier(opts=opts)
[rank7]: torch.distributed.DistBackendError: [7] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank7]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank7]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x148ee1723897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank7]: frame #1: <unknown function> + 0x57c6c1e (0x148f3aa8cc1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x148f3aa87667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x148f3aa87962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x148f3aa889b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148f3aa3cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148f3aa3cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148f3aa3cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x148ee29ef239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank7]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x148ee29f66c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank7]: frame #10: <unknown function> + 0x11b1f10 (0x148ee29fef10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank7]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x148ee2a00290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank7]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x148ee2a0edda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank5]: frame #13: <unknown function> + 0x57692d2 (0x14a8dc9472d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #14: <unknown function> + 0x5773d00 (0x14a8dc951d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #15: <unknown function> + 0x5773e05 (0x14a8dc951e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #16: <unknown function> + 0x4db0e26 (0x14a8dbf8ee26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #17: <unknown function> + 0x175be98 (0x14a8d8939e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #18: <unknown function> + 0x577e1b4 (0x14a8dc95c1b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #19: <unknown function> + 0x577ef65 (0x14a8dc95cf65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank5]: frame #20: <unknown function> + 0xd236c8 (0x14a8e48cc6c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank5]: frame #21: <unknown function> + 0x47e1ef (0x14a8e40271ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank5]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank5]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank5]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank5]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank5]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank5]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank5]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank5]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank5]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank5]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #13: <unknown function> + 0x57692d2 (0x148f3aa2f2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #14: <unknown function> + 0x5773d00 (0x148f3aa39d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #15: <unknown function> + 0x5773e05 (0x148f3aa39e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #16: <unknown function> + 0x4db0e26 (0x148f3a076e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #17: <unknown function> + 0x175be98 (0x148f36a21e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #18: <unknown function> + 0x577e1b4 (0x148f3aa441b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #19: <unknown function> + 0x577ef65 (0x148f3aa44f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank7]: frame #20: <unknown function> + 0xd236c8 (0x148f429b46c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank7]: frame #21: <unknown function> + 0x47e1ef (0x148f4210f1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank7]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank7]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank7]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank7]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank7]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank7]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank7]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank7]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank7]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank7]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank5]: frame #43: <unknown function> + 0x29590 (0x14a8fa429590 in /lib64/libc.so.6)
[rank5]: frame #44: __libc_start_main + 0x80 (0x14a8fa429640 in /lib64/libc.so.6)
[rank5]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank5]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank7]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank7]: frame #43: <unknown function> + 0x29590 (0x148f58429590 in /lib64/libc.so.6)
[rank7]: frame #44: __libc_start_main + 0x80 (0x148f58429640 in /lib64/libc.so.6)
[rank7]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank7]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank4]: Traceback (most recent call last):
[rank4]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank4]:     rank, local_rank, world_size = setup_ddp()
[rank4]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank4]:     dist.barrier()
[rank4]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank4]:     return func(*args, **kwargs)
[rank4]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank4]:     work = default_pg.barrier(opts=opts)
[rank4]: torch.distributed.DistBackendError: [4] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank4]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank4]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14e8a495f897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank4]: frame #1: <unknown function> + 0x57c6c1e (0x14e8fdcc8c1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14e8fdcc3667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14e8fdcc3962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14e8fdcc49b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e8fdc78d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e8fdc78d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e8fdc78d51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14e8a5c2b239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank4]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14e8a5c326c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank4]: frame #10: <unknown function> + 0x11b1f10 (0x14e8a5c3af10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank4]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14e8a5c3c290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank4]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14e8a5c4adda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank6]: Traceback (most recent call last):
[rank6]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank6]:     rank, local_rank, world_size = setup_ddp()
[rank6]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank6]:     dist.barrier()
[rank6]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank6]:     return func(*args, **kwargs)
[rank6]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank6]:     work = default_pg.barrier(opts=opts)
[rank6]: torch.distributed.DistBackendError: [6] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank6]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank6]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14de88a73897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank6]: frame #1: <unknown function> + 0x57c6c1e (0x14dee1ddcc1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14dee1dd7667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14dee1dd7962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14dee1dd89b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dee1d8cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dee1d8cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dee1d8cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14de89d3f239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank6]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14de89d466c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank6]: frame #10: <unknown function> + 0x11b1f10 (0x14de89d4ef10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank6]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14de89d50290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank6]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14de89d5edda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank4]: frame #13: <unknown function> + 0x57692d2 (0x14e8fdc6b2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #14: <unknown function> + 0x5773d00 (0x14e8fdc75d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #15: <unknown function> + 0x5773e05 (0x14e8fdc75e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #16: <unknown function> + 0x4db0e26 (0x14e8fd2b2e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #17: <unknown function> + 0x175be98 (0x14e8f9c5de98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #18: <unknown function> + 0x577e1b4 (0x14e8fdc801b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #19: <unknown function> + 0x577ef65 (0x14e8fdc80f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank4]: frame #20: <unknown function> + 0xd236c8 (0x14e905bf06c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank4]: frame #21: <unknown function> + 0x47e1ef (0x14e90534b1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank4]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank4]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank4]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank4]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank4]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank4]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank4]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank4]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank4]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank4]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #13: <unknown function> + 0x57692d2 (0x14dee1d7f2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #14: <unknown function> + 0x5773d00 (0x14dee1d89d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #15: <unknown function> + 0x5773e05 (0x14dee1d89e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #16: <unknown function> + 0x4db0e26 (0x14dee13c6e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #17: <unknown function> + 0x175be98 (0x14deddd71e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #18: <unknown function> + 0x577e1b4 (0x14dee1d941b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #19: <unknown function> + 0x577ef65 (0x14dee1d94f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank6]: frame #20: <unknown function> + 0xd236c8 (0x14dee9d046c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank6]: frame #21: <unknown function> + 0x47e1ef (0x14dee945f1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank6]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank6]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank6]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank6]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank6]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank6]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank6]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank6]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank6]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank6]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank4]: frame #43: <unknown function> + 0x29590 (0x14e91b629590 in /lib64/libc.so.6)
[rank4]: frame #44: __libc_start_main + 0x80 (0x14e91b629640 in /lib64/libc.so.6)
[rank4]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank4]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank6]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank6]: frame #43: <unknown function> + 0x29590 (0x14deff829590 in /lib64/libc.so.6)
[rank6]: frame #44: __libc_start_main + 0x80 (0x14deff829640 in /lib64/libc.so.6)
[rank6]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank6]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank8]: Traceback (most recent call last):
[rank8]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank8]:     rank, local_rank, world_size = setup_ddp()
[rank8]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank8]:     dist.barrier()
[rank8]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank8]:     return func(*args, **kwargs)
[rank8]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank8]:     work = default_pg.barrier(opts=opts)
[rank8]: torch.distributed.DistBackendError: [8] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank8]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank8]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14d3d13f1897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank8]: frame #1: <unknown function> + 0x57c6c1e (0x14d42a75ac1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14d42a755667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14d42a755962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14d42a7569b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d42a70ad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d42a70ad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d42a70ad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14d3d26bd239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14d3d26c46c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #10: <unknown function> + 0x11b1f10 (0x14d3d26ccf10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14d3d26ce290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14d3d26dcdda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: Traceback (most recent call last):
[rank11]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank11]:     rank, local_rank, world_size = setup_ddp()
[rank11]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank11]:     dist.barrier()
[rank11]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank11]:     return func(*args, **kwargs)
[rank11]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank11]:     work = default_pg.barrier(opts=opts)
[rank11]: torch.distributed.DistBackendError: [11] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank11]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank11]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x1542bbef3897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank11]: frame #1: <unknown function> + 0x57c6c1e (0x15431525cc1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x154315257667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x154315257962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x1543152589b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x15431520cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x15431520cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x15431520cd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x1542bd1bf239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x1542bd1c66c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #10: <unknown function> + 0x11b1f10 (0x1542bd1cef10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x1542bd1d0290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x1542bd1dedda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #13: <unknown function> + 0x57692d2 (0x14d42a6fd2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #14: <unknown function> + 0x5773d00 (0x14d42a707d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #15: <unknown function> + 0x5773e05 (0x14d42a707e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #16: <unknown function> + 0x4db0e26 (0x14d429d44e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #17: <unknown function> + 0x175be98 (0x14d4266efe98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #18: <unknown function> + 0x577e1b4 (0x14d42a7121b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #19: <unknown function> + 0x577ef65 (0x14d42a712f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #20: <unknown function> + 0xd236c8 (0x14d4326826c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #21: <unknown function> + 0x47e1ef (0x14d431ddd1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank8]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank8]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank8]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank8]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank8]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank8]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank8]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank8]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank8]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: Traceback (most recent call last):
[rank10]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank10]:     rank, local_rank, world_size = setup_ddp()
[rank10]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank10]:     dist.barrier()
[rank10]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank10]:     return func(*args, **kwargs)
[rank10]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank10]:     work = default_pg.barrier(opts=opts)
[rank10]: torch.distributed.DistBackendError: [10] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank10]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank10]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14ae100a3897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank10]: frame #1: <unknown function> + 0x57c6c1e (0x14ae6940cc1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14ae69407667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14ae69407962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14ae694089b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ae693bcd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ae693bcd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ae693bcd51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14ae1136f239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14ae113766c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #10: <unknown function> + 0x11b1f10 (0x14ae1137ef10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14ae11380290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14ae1138edda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #13: <unknown function> + 0x57692d2 (0x1543151ff2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #14: <unknown function> + 0x5773d00 (0x154315209d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #15: <unknown function> + 0x5773e05 (0x154315209e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #16: <unknown function> + 0x4db0e26 (0x154314846e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #17: <unknown function> + 0x175be98 (0x1543111f1e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #18: <unknown function> + 0x577e1b4 (0x1543152141b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #19: <unknown function> + 0x577ef65 (0x154315214f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #20: <unknown function> + 0xd236c8 (0x15431d1846c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #21: <unknown function> + 0x47e1ef (0x15431c8df1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank11]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank11]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank11]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank11]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank11]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank11]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank11]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank11]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank11]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank8]: frame #43: <unknown function> + 0x29590 (0x14d448029590 in /lib64/libc.so.6)
[rank8]: frame #44: __libc_start_main + 0x80 (0x14d448029640 in /lib64/libc.so.6)
[rank8]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank8]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank9]: Traceback (most recent call last):
[rank9]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 1069, in <module>
[rank9]:     rank, local_rank, world_size = setup_ddp()
[rank9]:   File "/hkfs/home/project/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/train_H100.py", line 63, in setup_ddp
[rank9]:     dist.barrier()
[rank9]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 75, in wrapper
[rank9]:     return func(*args, **kwargs)
[rank9]:   File "/home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3683, in barrier
[rank9]:     work = default_pg.barrier(opts=opts)
[rank9]: torch.distributed.DistBackendError: [9] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
[rank9]: Exception raised from recvBytes at /opt/conda/conda-bld/pytorch_1716905971093/work/torch/csrc/distributed/c10d/Utils.hpp:672 (most recent call first):
[rank9]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14f656fa1897 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libc10.so)
[rank9]: frame #1: <unknown function> + 0x57c6c1e (0x14f6b030ac1e in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x2c7 (0x14f6b0305667 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14f6b0305962 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14f6b03069b1 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f6b02bad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f6b02bad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f6b02bad51 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14f65826d239 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0xc50 (0x14f6582746c0 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #10: <unknown function> + 0x11b1f10 (0x14f65827cf10 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x10 (0x14f65827e290 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #12: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x66a (0x14f65828cdda in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #13: <unknown function> + 0x57692d2 (0x14ae693af2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #14: <unknown function> + 0x5773d00 (0x14ae693b9d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #15: <unknown function> + 0x5773e05 (0x14ae693b9e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #16: <unknown function> + 0x4db0e26 (0x14ae689f6e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #17: <unknown function> + 0x175be98 (0x14ae653a1e98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #18: <unknown function> + 0x577e1b4 (0x14ae693c41b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #19: <unknown function> + 0x577ef65 (0x14ae693c4f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #20: <unknown function> + 0xd236c8 (0x14ae713346c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #21: <unknown function> + 0x47e1ef (0x14ae70a8f1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank10]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank10]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank10]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank10]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank10]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank10]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank10]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank10]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank10]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank11]: frame #43: <unknown function> + 0x29590 (0x154332c29590 in /lib64/libc.so.6)
[rank11]: frame #44: __libc_start_main + 0x80 (0x154332c29640 in /lib64/libc.so.6)
[rank11]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank11]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank9]: frame #13: <unknown function> + 0x57692d2 (0x14f6b02ad2d2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #14: <unknown function> + 0x5773d00 (0x14f6b02b7d00 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #15: <unknown function> + 0x5773e05 (0x14f6b02b7e05 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #16: <unknown function> + 0x4db0e26 (0x14f6af8f4e26 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #17: <unknown function> + 0x175be98 (0x14f6ac29fe98 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #18: <unknown function> + 0x577e1b4 (0x14f6b02c21b4 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #19: <unknown function> + 0x577ef65 (0x14f6b02c2f65 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #20: <unknown function> + 0xd236c8 (0x14f6b82326c8 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #21: <unknown function> + 0x47e1ef (0x14f6b798d1ef in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #22: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x507107]
[rank9]: frame #23: _PyObject_MakeTpCall + 0x2ec (0x4f03bc in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #24: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x505020]
[rank9]: frame #25: _PyEval_EvalFrameDefault + 0x1237 (0x4e8867 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #26: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank9]: frame #27: _PyEval_EvalFrameDefault + 0x2f6b (0x4ea59b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #28: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank9]: frame #29: _PyFunction_Vectorcall + 0xd5 (0x4f7b25 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #30: _PyEval_EvalFrameDefault + 0x4d54 (0x4ec384 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #31: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4f7e03]
[rank9]: frame #32: _PyEval_EvalFrameDefault + 0x3cf (0x4e79ff in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #33: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x4e672a]
[rank9]: frame #34: _PyEval_EvalCodeWithName + 0x47 (0x4e63b7 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #35: PyEval_EvalCodeEx + 0x39 (0x4e6369 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #36: PyEval_EvalCode + 0x1b (0x59363b in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #37: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5c0ee7]
[rank9]: frame #38: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5bcef0]
[rank9]: frame #39: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x456252]
[rank9]: frame #40: PyRun_SimpleFileExFlags + 0x1a2 (0x5b6bf2 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #41: Py_RunMain + 0x37e (0x5b40ee in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank10]: frame #43: <unknown function> + 0x29590 (0x14ae86e29590 in /lib64/libc.so.6)
[rank10]: frame #44: __libc_start_main + 0x80 (0x14ae86e29640 in /lib64/libc.so.6)
[rank10]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank10]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank9]: frame #42: Py_BytesMain + 0x39 (0x5876f9 in /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python)
[rank9]: frame #43: <unknown function> + 0x29590 (0x14f6cdc29590 in /lib64/libc.so.6)
[rank9]: frame #44: __libc_start_main + 0x80 (0x14f6cdc29640 in /lib64/libc.so.6)
[rank9]: frame #45: /home/hk-project-p0022560/tum_fmp0582/anaconda3/envs/myenv1/bin/python() [0x5875ae]
[rank9]: . This may indicate a possible application crash on rank 0 or a network set up issue.
srun: error: hkn0428: tasks 0,3: Exited with exit code 1
srun: error: hkn0627: tasks 8,10: Exited with exit code 1
srun: error: hkn0428: task 2: Exited with exit code 1
srun: error: hkn0627: tasks 9,11: Exited with exit code 1
srun: error: hkn0436: tasks 4-7: Exited with exit code 1
