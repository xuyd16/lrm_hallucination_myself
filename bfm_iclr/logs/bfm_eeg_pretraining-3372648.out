Thu Jul 24 21:36:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100                    On  |   00000000:06:00.0 Off |                    0 |
| N/A   41C    P0             69W /  415W |      27MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100                    On  |   00000000:26:00.0 Off |                    0 |
| N/A   41C    P0             67W /  415W |      27MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100                    On  |   00000000:A6:00.0 Off |                    0 |
| N/A   42C    P0             69W /  415W |      27MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100                    On  |   00000000:C6:00.0 Off |                    0 |
| N/A   42C    P0             68W /  415W |      27MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A            3120      G   /usr/libexec/Xorg                        17MiB |
|    1   N/A  N/A            3120      G   /usr/libexec/Xorg                        17MiB |
|    2   N/A  N/A            3120      G   /usr/libexec/Xorg                        17MiB |
|    3   N/A  N/A            3120      G   /usr/libexec/Xorg                        17MiB |
+-----------------------------------------------------------------------------------------+
=== BFM EEG Pre-training Job Started ===
Job started on hkn0906.localdomain at Thu Jul 24 09:36:58 PM CEST 2025
Current working directory: /home/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr
Job ID: 3372648
Master Addr: hkn0906
Master Port: 29500
=== Environment Setup Complete ===
CUDA available: True
GPU count: 4
=== Starting EEG Model Pre-training ===
GpuFreq=control_disabled
GpuFreq=control_disabled
DDPåˆå§‹åŒ–æˆåŠŸ: rank=0, local_rank=0, world_size=8
ä½¿ç”¨è®¾å¤‡: cuda:0
å¯ç”¨GPUæ•°é‡: 4
  GPU 0: NVIDIA H100
    æ˜¾å­˜: 93.1 GB
  GPU 1: NVIDIA H100
    æ˜¾å­˜: 93.1 GB
  GPU 2: NVIDIA H100
    æ˜¾å­˜: 93.1 GB
  GPU 3: NVIDIA H100
    æ˜¾å­˜: 93.1 GB

=== æ¨¡å‹é…ç½®ä¿¡æ¯ ===
num_regions: 5
max_electrodes_per_region: 24
sequence_length: 1600
embed_dim: 896
num_heads: 32
depth: 28
mlp_ratio: 4.0
drop_rate: 0.2
attn_drop_rate: 0.2
drop_path_rate: 0.2
use_abs_pos: False
use_rel_pos: True
use_time_embed: True
mask_ratio: 0.15
freq_mask_ratio: 0.3
mask_strategy: random
mask_noise_ratio: 0.005
use_moe: True
num_experts: 18
top_k_experts: 2
moe_aux_loss_coeff: 0.01
n_freq_bands: 5
freq_loss_weight: 0.1
time_loss_weight: 0.9
lr: 0.0001
weight_decay: 0.0001
warmup_epochs: 5
use_amp: True
clip_grad: 0.1
batch_size: 4
use_layer_norm: True
use_batch_norm: True
eps: 1e-08
init_std: 0.02
electrode_names: ['Fp1', 'Fp2', 'F3', 'F4', 'F7', 'F8', 'Fz', 'C3', 'C4', 'Cz', 'P3', 'P4', 'P7', 'P8', 'Pz', 'O1', 'O2', 'Oz', 'T3', 'T4', 'T5', 'T6']
region_names: ['frontal', 'central', 'parietal', 'temporal', 'occipital']
debug: False
freq_eval: True
use_channel_embed: True
channel_embed_dim: 32
num_brain_regions: 5
channel_gat_initial_dim: 32
intra_region_gat_heads: 4
intra_region_gat_dim_per_head: 32
region_agg_attention_dim: 64
inter_region_gat_heads: 4
inter_region_gat_dim_per_head: 64
æ¨¡å‹å·²åˆ›å»ºå¹¶ç§»åŠ¨åˆ°è®¾å¤‡: cuda:0
æ¨¡å‹å·²ä½¿ç”¨DDPå°è£…åœ¨è®¾å¤‡ 0
ä¼˜åŒ–å™¨å·²åˆ›å»ºï¼Œå­¦ä¹ ç‡: 0.0001
DDPè®­ç»ƒï¼Œä¸–ç•Œå¤§å°: 8, æœ‰æ•ˆæ‰¹æ¬¡å¤§å°: 32
åŠ¨æ€æ¢¯åº¦ç´¯ç§¯è®¾ç½®:
  ç›®æ ‡å…¨å±€æ‰¹æ¬¡å¤§å°: 128
  å½“å‰å…¨å±€æ‰¹æ¬¡å¤§å°: 32
  æ¢¯åº¦ç´¯ç§¯æ­¥æ•°: 4
  å®é™…æœ‰æ•ˆå…¨å±€æ‰¹æ¬¡å¤§å°: 128
è®­ç»ƒå™¨å·²åˆ›å»º

============================================================
                           æ¨¡å‹å‚æ•°ç»Ÿè®¡                           
============================================================
æ€»å‚æ•°é‡:                3,359,409,168
å¯è®­ç»ƒå‚æ•°:               3,359,409,168
å†»ç»“å‚æ•°:                0
å‚æ•°å¤§å°:                12815.13 MB (FP32)
å‚æ•°å¤§å°:                6407.56 MB (FP16)

------------------------------------------------------------
                          ä¸»è¦æ¨¡å—å‚æ•°åˆ†å¸ƒ                          
------------------------------------------------------------
fusion_module.mlp_t.0                     3,214,848 (  0.1%)
fusion_module.mlp_f.0                     3,214,848 (  0.1%)
layers.0.mlp.experts.0.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.1.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.2.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.3.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.4.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.5.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.6.0                  3,214,848 (  0.1%)
layers.0.mlp.experts.7.0                  3,214,848 (  0.1%)
å…¶ä»–æ¨¡å—                                     3,322,437,514 ( 98.9%)
============================================================

æ­£åœ¨åŠ è½½æ•°æ®: /home/hk-project-p0022560/tum_fmp0582/ict/bfm_iclr/processed_data1
æ•°æ®é›†åˆå§‹åŒ–å®Œæˆ: å…±4289ä¸ªæ–‡ä»¶, æ€»æ ·æœ¬æ•°: 4508290
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®é›†åˆå§‹åŒ–å®Œæˆ: å…±4289ä¸ªæ–‡ä»¶, æ€»æ ·æœ¬æ•°: 4508290
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4

==================================================
å¼€å§‹è®­ç»ƒ DualDomain Neural Transformer MEM æ¨¡å‹
å…±100ä¸ªå‘¨æœŸï¼Œæ‰¹æ¬¡å¤§å°:4
==================================================

å­¦ä¹ ç‡è°ƒåº¦å™¨å·²åˆå§‹åŒ–ï¼Œæ€»è®­ç»ƒepochs: 100, æ¯ä¸ªepochçš„æ­¥æ•°: 140884
æ€»è®­ç»ƒæ­¥æ•°: 14088400
å­¦ä¹ ç‡è°ƒåº¦å™¨è®¾ç½®æˆåŠŸ
æ•°æ®åŠ è½½å™¨å·²åˆ›å»º: æ ·æœ¬æ•°=4508290, æ‰¹æ¬¡å¤§å°=4
è­¦å‘Š: æœªæ‰¾åˆ°TensorBoardï¼Œå°†ä¸ä¼šè®°å½•è®­ç»ƒæ—¥å¿—

==================================================
     DualDomain Neural Transformer MEM æ¨¡å‹è®­ç»ƒå¼€å§‹     
==================================================
                     æœ¬æ¬¡è¿è¡Œæ–‡ä»¶å¤¹                      
--------------------------------------------------
è¿è¡Œæ–‡ä»¶å¤¹:          checkpoint/20250724_213808
æœ€ä½³æ¨¡å‹:           checkpoint/20250724_213808/best_model.pt
æœ€åæ¨¡å‹:           checkpoint/20250724_213808/last_model.pt
--------------------------------------------------
                      æ¨¡å‹å‚æ•°ç»Ÿè®¡                      
--------------------------------------------------
æ€»å‚æ•°é‡:           3,359,409,168
å¯è®­ç»ƒå‚æ•°:          3,359,409,168
å†»ç»“å‚æ•°:           0
å†…å­˜å ç”¨(FP32):     12815.1 MB
å†…å­˜å ç”¨(FP16):     6407.6 MB

                     ä¸»è¦ç»„ä»¶å‚æ•°åˆ†å¸ƒ                     
--------------------------------------------------
layers               3,329,704,448 ( 99.1%)
fusion_module          20,899,200 (  0.6%)
region_projection       5,789,958 (  0.2%)
time_reconstruction_head1    1,435,200 (  0.0%)
time_reconstruction_head2    1,435,200 (  0.0%)
positional_embedding      107,520 (  0.0%)
intra_region_pos_embedding       21,504 (  0.0%)
freq_reconstruction_head1        4,485 (  0.0%)
freq_reconstruction_head2        4,485 (  0.0%)
region_embedding            4,480 (  0.0%)
norm                        1,792 (  0.0%)

                      è®­ç»ƒé…ç½®ä¿¡æ¯                      
--------------------------------------------------
è®­ç»ƒå‘¨æœŸ:           100
æ‰¹æ¬¡å¤§å°:           4
æœ‰æ•ˆæ‰¹æ¬¡å¤§å°:         32
è®¾å¤‡:             cuda:0
DDPä¸–ç•Œå¤§å°:        8
DDPæ¨¡å¼:          å¯ç”¨
å­¦ä¹ ç‡:            0.0001
æ—¶åŸŸæŸå¤±æƒé‡:         0.9
é¢‘åŸŸæŸå¤±æƒé‡:         0.1
æ··åˆç²¾åº¦:           å¯ç”¨
æ¢¯åº¦ç´¯ç§¯æ­¥æ•°:         4
æ¯ä¸ªå‘¨æœŸçš„æ­¥æ•°:        140884
==================================================


Epoch 1/100
--------------------------------------------------
åºåˆ—é•¿åº¦ (R*E): 120
æ—¶åŸŸé¢„æµ‹å½¢çŠ¶: torch.Size([4, 120, 1600]), ç›®æ ‡å½¢çŠ¶: torch.Size([4, 120, 1600])
é¢‘åŸŸé¢„æµ‹å½¢çŠ¶: torch.Size([4, 120, 5]), ç›®æ ‡å½¢çŠ¶: torch.Size([4, 120, 5])
è®­ç»ƒè¿›åº¦: [=                   ] 1/140884 | æ€»æŸå¤±: 0.78945160 | æ—¶åŸŸ: 0.81045353 | é¢‘åŸŸ: 3.51309967 | LR: 0.00000200 | ç”¨æ—¶: 2.9ç§’è®­ç»ƒè¿›åº¦: [=                   ] 7045/140884 | æ€»æŸå¤±: 0.21320346 | æ—¶åŸŸ: 0.11114134 | é¢‘åŸŸ: 1.31494975 | LR: 0.00000200 | ç”¨æ—¶: 9109.4ç§’è®­ç»ƒè¿›åº¦: [==                  ] 14089/140884 | æ€»æŸå¤±: 0.24632919 | æ—¶åŸŸ: 0.20183073 | é¢‘åŸŸ: 1.33897352 | LR: 0.00000200 | ç”¨æ—¶: 18258.0ç§’è®­ç»ƒè¿›åº¦: [===                 ] 21133/140884 | æ€»æŸå¤±: 0.18930385 | æ—¶åŸŸ: 0.10646324 | é¢‘åŸŸ: 0.78776348 | LR: 0.00000200 | ç”¨æ—¶: 27388.4ç§’è®­ç»ƒè¿›åº¦: [====                ] 28177/140884 | æ€»æŸå¤±: 0.19640394 | æ—¶åŸŸ: 0.10666082 | é¢‘åŸŸ: 0.97077489 | LR: 0.00000200 | ç”¨æ—¶: 36488.4ç§’è®­ç»ƒè¿›åº¦: [=====               ] 35221/140884 | æ€»æŸå¤±: 0.19719169 | æ—¶åŸŸ: 0.11498356 | é¢‘åŸŸ: 0.91510642 | LR: 0.00000200 | ç”¨æ—¶: 45562.7ç§’è®­ç»ƒè¿›åº¦: [======              ] 42265/140884 | æ€»æŸå¤±: 0.19314437 | æ—¶åŸŸ: 0.11641151 | é¢‘åŸŸ: 0.80889750 | LR: 0.00000200 | ç”¨æ—¶: 54639.8ç§’è®­ç»ƒè¿›åº¦: [=======             ] 49309/140884 | æ€»æŸå¤±: 0.19230422 | æ—¶åŸŸ: 0.09751773 | é¢‘åŸŸ: 0.96083653 | LR: 0.00000200 | ç”¨æ—¶: 63717.9ç§’è®­ç»ƒè¿›åº¦: [========            ] 56353/140884 | æ€»æŸå¤±: 0.18231478 | æ—¶åŸŸ: 0.09110337 | é¢‘åŸŸ: 0.76876378 | LR: 0.00000200 | ç”¨æ—¶: 72793.6ç§’è®­ç»ƒè¿›åº¦: [=========           ] 63397/140884 | æ€»æŸå¤±: 0.18697162 | æ—¶åŸŸ: 0.09905870 | é¢‘åŸŸ: 0.81401026 | LR: 0.00000200 | ç”¨æ—¶: 81874.3ç§’è®­ç»ƒè¿›åº¦: [==========          ] 70441/140884 | æ€»æŸå¤±: 0.23281744 | æ—¶åŸŸ: 0.20061740 | é¢‘åŸŸ: 1.04119003 | LR: 0.00000200 | ç”¨æ—¶: 90954.2ç§’è®­ç»ƒè¿›åº¦: [===========         ] 77485/140884 | æ€»æŸå¤±: 0.22547834 | æ—¶åŸŸ: 0.20563941 | é¢‘åŸŸ: 0.82227683 | LR: 0.00000200 | ç”¨æ—¶: 100036.3ç§’è®­ç»ƒè¿›åº¦: [============        ] 84529/140884 | æ€»æŸå¤±: 0.20605972 | æ—¶åŸŸ: 0.16387957 | é¢‘åŸŸ: 0.70366955 | LR: 0.00000200 | ç”¨æ—¶: 109119.3ç§’è®­ç»ƒè¿›åº¦: [=============       ] 91573/140884 | æsrun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 3372648.0 ON hkn0906 CANCELLED AT 2025-07-26T21:36:47 DUE TO TIME LIMIT ***
srun: got SIGCONT

============================= JOB FEEDBACK =============================

Job ID: 3372648
Cluster: hk
User/Group: tum_fmp0582/hk-project-p0022560
Account: hk-project-p0022560
State: TIMEOUT (exit code 0)
Partition: accelerated-h100
Nodes: 2
Cores per node: 128
Nodelist: hkn[0906,0922]
CPU Utilized: 20-23:54:11
CPU Efficiency: 4.10% of 512-01:55:12 core-walltime
Job Wall-clock time: 2-00:00:27
Starttime: Thu Jul 24 21:36:20 2025
Endtime: Sat Jul 26 21:36:47 2025
Memory Utilized: 113.99 GB (estimated maximum)
Memory Efficiency: 0.00% of 0.00 MB (0.00 MB/node)
Energy Consumed: 478816515 Joule / 133004.5875 Watthours
Average node power draw: 2770.49601624746 Watt
